# USACE CWMS Location Configuration — Peoria / Upper Peoria Lake Flood Monitor
#
# This file contains USACE Corps Water Management System (CWMS) lock and dam
# locations for flood monitoring. Locations are loaded at startup and timeseries
# IDs are discovered via the CWMS catalog API.
#
# DATUM NOTES:
#   - Illinois Waterway pool elevations use NGVD29 (National Geodetic Vertical Datum 1929)
#   - Lockport pool elevation uses IGLD (International Great Lakes Datum); add 1.3 ft to convert to NGVD29
#   - USGS stage readings use NAVD88 at most modern gauges — be careful mixing datums
#
# CWMS API BASE:   https://cwms-data.usace.army.mil/cwms-data/
# RIVERGAGES BASE: https://rivergages.mvr.usace.army.mil/WaterControl/
#
# CWMS location ID format for timeseries: {LOCATION}.{PARAM}.{TYPE}.{INTERVAL}.{DURATION}.{VERSION}
# Example: Peoria-Pool.Elev.Inst.~1Hour.0.CBT-RAW
#
# SHEF IDs are the legacy identifiers used in the rivergages.mvr.usace.army.mil system.
# They map directly to CWMS location names in the MVR office database.
# ─────────────────────────────────────────────────────────────────────────────


# =============================================================================
# SECTION 1: ILLINOIS WATERWAY — LOCKS AND DAMS (MVR District)
# All upstream of Peoria. Ordered downstream → upstream.
# These are your primary upstream warning chain.
# =============================================================================

[[usace_stations]]
shef_id         = "IL07"
shef_pool_id    = "IL07P"
cwms_location   = "Peoria-Pool"
office          = "MVR"
name            = "Illinois River at Peoria Lock and Dam"
river_mile      = 157.6
pool_elevation_target_ft_ngvd29 = 447.0
data_types      = ["pool_elevation", "tailwater_elevation", "lockage"]
relevance = "PRIMARY — directly controls Upper Peoria Lake level. Pool elevation here is the most operationally important USACE reading for your property. When pool rises significantly above 447.0 ft NGVD29, backwater flooding on the east bank (Sunset Drive / Woodford Co.) begins. Wicket dam — lays flat during major floods, removing pool control and allowing the river to run free."
flood_note = "Wicket dam operation: when wickets are laid down, pool is no longer managed and stage is governed entirely by river flow and Mississippi backwater."

[[usace_stations]]
shef_id         = "IL06"
shef_pool_id    = "IL06P"
cwms_location   = "Starved-Rock-Pool"
office          = "MVR"
name            = "Illinois River at Starved Rock Lock and Dam"
river_mile      = 231.0
data_types      = ["pool_elevation", "tailwater_elevation", "lockage", "met"]
relevance = "HIGH UPSTREAM WARNING — closest major upstream structure to Peoria on the main stem. Rising pool or tailwater here gives 24–48 hour lead time for Peoria. Also has a MET (meteorological) station (SHEF: SRDI2) monitoring local precip and temperature — useful for correlating rainfall with flow response in the Starved Rock reach."

[[usace_stations]]
shef_id         = "IL05"
shef_pool_id    = "IL05P"
cwms_location   = "Marseilles-Pool"
office          = "MVR"
name            = "Illinois River at Marseilles Lock and Dam"
river_mile      = 247.0
tailwater_river_mile = 244.5
data_types      = ["pool_elevation", "tailwater_elevation", "lockage"]
relevance = "UPSTREAM WARNING — approximately 90 miles upstream. Marseilles pool and tailwater rising indicates a significant pulse is moving down the main stem. 36–60 hour lead time for Peoria depending on flow velocity. Marseilles Canal bypasses the dam; tailwater gauge at RM 244.5 is the free-flow reference."

[[usace_stations]]
shef_id         = "IL04"
shef_pool_id    = "IL04P"
cwms_location   = "Dresden-Island-Pool"
office          = "MVR"
name            = "Illinois River at Dresden Island Lock and Dam"
river_mile      = 271.5
data_types      = ["pool_elevation", "tailwater_elevation", "lockage", "met"]
relevance = "CONFLUENCE MONITOR — located at the junction of the Kankakee and Des Plaines rivers where the Illinois River is born. Pool elevation here reflects combined input from the entire Chicago metro drainage plus the Kankakee basin. A critical early indicator when large volumes are entering the system from the northeast. MET station (SHEF: DRSI2) available."

[[usace_stations]]
shef_id         = "IL03"
shef_pool_id    = "IL03P"
cwms_location   = "Brandon-Road-Pool"
office          = "MVR"
name            = "Illinois River at Brandon Road Lock and Dam"
river_mile      = 285.9
data_types      = ["pool_elevation", "tailwater_elevation", "lockage", "met"]
relevance = "CHICAGO METRO OUTFLOW MONITOR — together with Lockport, this is your window into what the Chicago metropolitan area is contributing to the system. MWRD release events appear here before propagating downstream. MET station (SHEF: JOLI2) available."

[[usace_stations]]
shef_id         = "IL02"
shef_pool_id    = "IL02P"
cwms_location   = "Lockport-Pool"
office          = "MVR"
name            = "Chicago Sanitary and Ship Canal at Lockport Lock and Dam"
river_mile      = 291.1
datum_note      = "Pool elevation referenced to IGLD; add 1.3 ft to convert to NGVD29"
data_types      = ["pool_elevation", "tailwater_elevation", "lockage"]
relevance = "LAKE MICHIGAN INFLOW CONTROL POINT — the upstream terminus of the Illinois Waterway system. Controls flow from the Chicago Sanitary and Ship Canal into the river system. MWRD operates the powerhouse here. When Lake Michigan levels are high and MWRD is releasing heavily during storm events, elevated readings here will propagate down through Brandon Road, Dresden Island, and eventually Peoria over the following days."


# =============================================================================
# SECTION 2: ILLINOIS WATERWAY — DOWNSTREAM OF PEORIA (MVR District)
# Monitor for backwater from the Mississippi pushing back up into Peoria pool.
# =============================================================================

[[usace_stations]]
shef_id         = "IL08"
shef_pool_id    = "IL08P"
cwms_location   = "LaGrange-Pool"
office          = "MVR"
name            = "Illinois River at New LaGrange Lock and Dam"
river_mile      = 80.2
data_types      = ["pool_elevation", "tailwater_elevation", "lockage"]
relevance = "CRITICAL BACKWATER INDICATOR — LaGrange is the last lock and dam before the Mississippi confluence at Grafton (RM 0). When the Mississippi is flooding, backwater pushes up through LaGrange and can elevate pool levels all the way to Peoria. This is the 'floods from the bottom up' mechanism. Monitor LaGrange tailwater carefully — when tailwater approaches or exceeds pool elevation, the dam has lost hydraulic control and Mississippi backwater is dominant. This is also a wicket dam and lays flat during major floods."
flood_note = "LaGrange tailwater == Mississippi backwater proxy. When LaGrange tailwater rises sharply without corresponding upstream flow increase, Mississippi is driving the event."


# =============================================================================
# SECTION 3: MISSISSIPPI RIVER — BACKWATER SOURCE STATIONS (MVS/MVR District)
# These are what push water back up the Illinois toward Peoria.
# =============================================================================

[[usace_stations]]
shef_id         = "GRFI2"
cwms_location   = "Grafton"
office          = "MVS"
name            = "Mississippi River at Grafton, IL"
river_mile_above_ohio = 218.0
data_types      = ["stage", "discharge"]
relevance = "BACKWATER ORIGIN — located 0.2 miles downstream from the Illinois River confluence. This is the most direct indicator of Mississippi River stage driving backwater into the Illinois. When Grafton stage rises above approximately 20 ft, backwater begins affecting LaGrange pool. Above ~25 ft, backwater influence is felt at Peoria. Operated by MVS (St. Louis District) in coordination with USGS."
flood_note = "Cross-reference with USGS 05587450 (Illinois River at Grafton) for combined flow context."

[[usace_stations]]
name            = "Mississippi River at Alton, IL"
cwms_location   = "Alton-IL"
shef_id         = "ALTI2"
office          = "MVS"
data_types      = ["stage", "discharge"]
relevance = "UPSTREAM MISSISSIPPI REFERENCE — Alton is upstream of Grafton and gives 6–12 hour lead time on what Grafton stage will do. When Alton is at major flood stage, Grafton will follow and backwater into the Illinois is almost certain. Useful for extending your backwater alert lead time."

[[usace_stations]]
name            = "Mississippi River at Hannibal, MO"
cwms_location   = "Hannibal-MO"
shef_id         = "HNLM7"
office          = "MVS"
data_types      = ["stage", "discharge"]
relevance = "EXTENDED BACKWATER LEAD TIME — Hannibal is ~120 miles upstream of Grafton. Major flooding at Hannibal provides 2–4 day advance warning that a large Mississippi pulse is approaching the Illinois confluence. Useful for early alerting during major river events."


# =============================================================================
# SECTION 4: CWMS API — HOW TO QUERY THESE STATIONS
# =============================================================================

# CWMS timeseries endpoint:
#   GET https://cwms-data.usace.army.mil/cwms-data/timeseries
#   Params:
#     name     = {CWMS location timeseries ID}
#     office   = MVR  (or MVS for Mississippi stations)
#     begin    = ISO 8601 datetime
#     end      = ISO 8601 datetime
#     format   = json
#
# Example — Peoria pool elevation, last 24 hours:
#   https://cwms-data.usace.army.mil/cwms-data/timeseries
#     ?name=Peoria-Pool.Elev.Inst.~1Hour.0.CBT-RAW
#     &office=MVR
#     &begin=2024-05-01T00:00:00-05:00
#     &end=2024-05-02T00:00:00-05:00
#     &format=json
#
# Example — LaGrange pool and tailwater:
#   ?name=LaGrange-Pool.Elev.Inst.~1Hour.0.CBT-RAW&office=MVR
#   ?name=LaGrange-TW.Elev.Inst.~1Hour.0.CBT-RAW&office=MVR
#
# CWMS locations endpoint (discover all available location IDs for an office):
#   GET https://cwms-data.usace.army.mil/cwms-data/locations?office=MVR&format=json
#
# CWMS catalog endpoint (discover all available timeseries for a location):
#   GET https://cwms-data.usace.army.mil/cwms-data/catalog/TIMESERIES
#     ?office=MVR
#     &like=Peoria.*
#     &format=json
#
# NOTE: Exact CWMS timeseries IDs (the full dotted string) must be verified
# against the catalog endpoint — the version and source suffixes (e.g.
# "CBT-RAW" vs "lrgs-rev") vary by office and data stream. Use the catalog
# query to enumerate what's actually available for each location before
# hardcoding timeseries IDs in your service.
